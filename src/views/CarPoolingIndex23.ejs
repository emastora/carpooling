<!DOCTYPE HTML>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <script src="components/loader.js"></script>
    <script src="components/monaca-jquery/jquery.js" type="text/javascript"></script>
    <!-- <script src="components/loader.js"></script> -->
    <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.js"></script>
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> -->
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <meta name="description" content="">
    <meta name="author" content="">
    <% include partials/head %>

        <script src="https://unpkg.com/onsenui/js/onsenui.min.js"></script>
        <!-- <script src="https://unpkg.com/angularjs-onsenui/js/angularjs-onsenui.min.js"></script> -->
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/onsen/2.5.1/js/angular-onsenui.min.js"></script> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/onsen/2.10.6/js/angular-onsenui.min.js"></script>


        <title>CarPooling App</title>

        <script>
            ons.bootstrap();


            ons.ready(function() {
                //******************Check Authentication******************//
                if (localStorage.length >= 1) { //User is logedin
                    // document.getElementById('unauthenticated').className = "hide";
                    // document.getElementById('authenticated').className = "show";

                    // googleLogin();
                    // getToken();
                    // loadVehicles();
                    removeOldJourneys();

                    //******************Start Intervals******************//
                    startIntervalForFindMatchingJourneys();
                    startIntervalsForEachLocalJourney();
                    startIntervalsForEachAcceptedJourney();
                    startIntervalsForRating();

                    startIntervalForMessages();
                    startIntervalForGetSentMessages();
                }
                //  else {
                // document.getElementById('unauthenticated').className = "show";
                // document.getElementById('authenticated').className = "hide";
                // }

                //Google Login
                // googleLogin();
            });
        </script>

</head>

<body>
    <ons-sliding-menu var="app.slidingMenu" menu-page="menu.html" main-page="map.html" side="left" type="overlay" max-slide-distance="250px">
    </ons-sliding-menu>

    CarPooling App

    <ons-button onclick="alert('You clicked me!')">Click Me</ons-button>

    <script>
        document.addEventListener("pageinit", function(e) {

            if (e.target.id == "personal_inf") {
                loadPersonalInf();
                // startIntervalForFindMatchingJourneys();
            }

            if (e.target.id == "edit_personal") {
                loadPersonalInfVal();
            }

            if (e.target.id == "FBprofile") {
                testAPI();
                testAPI2();
            }

            if (e.target.id == "my_journeys_passenger") {
                loadJourneysPassenger();
            }

            if (e.target.id == "my_journeys_driver") {
                loadJourneysDriver();
            }

            if (e.target.id == "my_journeys_matching") {
                //$(".tab-bar").show();
                loadJourneysMatching();
            }

            if (e.target.id == "journey") {
                loadJourneyVal();
            }

            if (e.target.id == "journey_matching") {
                loadMatchingJourneyVal();
            }

            if (e.target.id == "journey_accepted") {
                loadAcceptedJourneyVal();
            }

            if (e.target.id == "new_vehicle") {
                loadNewVehicleInf();
            }

            if (e.target.id == "edit_vehicle") {
                // loadVehicleInfVal();
            }

            if (e.target.id == "vehicle_inf") {
                loadVehicleInf();
            }

            if (e.target.id == "my_vehicles") {
                loadVehiclesList();
            }

            if (e.target.id == "ratings_driver") {
                loadJourneysDriver();
            }

            if (e.target.id == "main_map") {
                loadMap();
                onCloseApp();
                modal.show();
            }

            if (e.target.id == "others_personal_inf") {
                loadOthersPersonalInf();
            }

            // if (e.target.id == "others_personal_inf_message") {
            //     loadOthersPersonalInf();
            // }

            if (e.target.id == "pending_personal_inf") {
                loadPendingPersonalInf();
            }

            if (e.target.id == "others_vehicle_inf") {
                loadOtherVehicleInf();
            }

            if (e.target.id == "my_messages") {
                loadMessagesList();
            }

            if (e.target.id == "message") {
                loadMessageVal();
                setTimeout(function() {
                    document.getElementById('scrollDown').click();
                }, 1000);
            }
        }, false);
    </script>

    <!-- Leaflet -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.3.4/dist/leaflet.css" integrity="sha512-puBpdR0798OZvTTbP4A8Ix/l+A4dHDD0DGqYW6RQ+9jxkRFclaxxQb/SJAWZfWAkuyeQUytO7+7N4QKrDh+drA==" crossorigin="" />
    <script src="https://unpkg.com/leaflet@1.3.4/dist/leaflet.js" integrity="sha512-nMMmRyTVoLYqjP9hrbed9S+FzjZHW5gY1TWCHA5ckwXZBadntCNs8kEqAWdrb9O7rxbCaA4lKTIWjDXZxflOcA==" crossorigin=""></script>

    <!-- Leaflet Routing Machine -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.2.0/dist/leaflet.css" />
    <link rel="stylesheet" href="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.css" />
    <script src="https://unpkg.com/leaflet@1.2.0/dist/leaflet.js"></script>
    <script src="https://unpkg.com/leaflet-routing-machine@latest/dist/leaflet-routing-machine.js"></script>

    <script src="js/functionsDM.js"></script>
    <script src="js/functions.js"></script>

    <script src="js/core.js"></script>


</body>

</html>